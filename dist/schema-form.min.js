!function(e,t){"function"==typeof define&&define.amd?define(["angular"],t):t(angular)}(this,function(e){var t=["ObjectPath"];try{e.module("ngSanitize"),t.push("ngSanitize")}catch(r){}try{e.module("ui.sortable"),t.push("ui.sortable")}catch(r){}try{e.module("angularSpectrumColorpicker"),t.push("angularSpectrumColorpicker")}catch(r){}e.module("schemaForm",t)}),function(e,t){"function"==typeof define&&define.amd?define(["angular","angular-schema-form/module","ObjectPath"],t):t(angular)}(this,function(e){e.module("schemaForm").provider("sfPath",["ObjectPathProvider",function(t){var r={parse:t.parse};r.stringify=1===e.version.major&&e.version.minor<3?function(e){return Array.isArray(e)?e.join("."):e.toString()}:t.stringify,r.normalize=function(e,t){return r.stringify(Array.isArray(e)?e:r.parse(e),t)},this.parse=r.parse,this.stringify=r.stringify,this.normalize=r.normalize,this.$get=function(){return r}}])}),function(e,t){"function"==typeof define&&define.amd?define(["angular","angular-schema-form/module","angular-schema-form/sfPath"],t):t(angular)}(this,function(e){e.module("schemaForm").factory("sfSelect",["sfPath",function(e){var t=/^\d+$/;return function(r,n,i){n||(n=this);var a="string"==typeof r?e.parse(r):r;if("undefined"!=typeof i&&1===a.length)return n[a[0]]=i,n;"undefined"!=typeof i&&"undefined"==typeof n[a[0]]&&(n[a[0]]=a.length>2&&t.test(a[1])?[]:{});for(var o=n[a[0]],u=1;u<a.length;u++){if(""===a[u])return void 0;if("undefined"!=typeof i){if(u===a.length-1)return o[a[u]]=i,i;var f=o[a[u]];("undefined"==typeof f||null===f)&&(f=t.test(a[u+1])?[]:{},o[a[u]]=f),o=f}else o&&(o=o[a[u]])}return o}}])}),function(e,t){"function"==typeof define&&define.amd?define(["angular","angular-schema-form/module","angular-schema-form/sfPath"],t):t(angular)}(this,function(e){e.module("schemaForm").provider("schemaFormDecorators",["$compileProvider","sfPathProvider",function(t,r){var n="",i={},a=function(e,t){"sfDecorator"===e&&(e=n);for(var r=i[e],a=r.rules,o=0;o<a.length;o++){var u=a[o](t);if(u)return u}return r.mappings[t.type]?r.mappings[t.type]:r.mappings["default"]},o=function(n){t.directive(n,["$parse","$compile","$http","$templateCache",function(t,i,o,u){return{restrict:"AE",replace:!1,transclude:!1,scope:!0,require:"?^sfSchema",link:function(t,f,s,c){var l=t.$watch(s.form,function(e){if(e){t.form=e;var s=a(n,e);o.get(s,{cache:u}).then(function(n){var a=e.key?r.stringify(e.key).replace(/"/g,"&quot;"):"",o=n.data.replace(/\$\$value\$\$/g,"model"+("["!==a[0]?".":"")+a);f.html(o),i(f.contents())(t)}),l()}});t.showTitle=function(){return t.form&&t.form.notitle!==!0&&t.form.title},t.listToCheckboxValues=function(t){var r={};return e.forEach(t,function(e){r[e]=!0}),r},t.checkboxValuesToList=function(t){var r=[];return e.forEach(t,function(e,t){e&&r.push(t)}),r},t.buttonClick=function(r,n){e.isFunction(n.onClick)?n.onClick(r,n):e.isString(n.onClick)&&(c?c.evalInParentScope(n.onClick,{$event:r,form:n}):t.$eval(n.onClick,{$event:r,form:n}))},t.evalExpr=function(e,r){return c?c.evalInParentScope(e,r):t.$eval(e,r)},t.evalInScope=function(e,r){return e?t.$eval(e,r):void 0},t.errorMessage=function(r){return t.form.validationMessage?r?e.isString(t.form.validationMessage)?t.form.validationMessage:t.form.validationMessage[r.code]||t.form.validationMessage["default"]:t.form.validationMessage.required||t.form.validationMessage["default"]||t.form.validationMessage:r?r.message:"Required"}}}}])},u=function(r,n,i){i=e.isDefined(i)?i:!1,t.directive("sf"+e.uppercase(r[0])+r.substr(1),function(){return{restrict:"EAC",scope:!0,replace:!0,transclude:i,template:'<sf-decorator form="form"></sf-decorator>',link:function(t,n,i){var a={items:"c",titleMap:"c",schema:"c"},o={type:r},u=!0;e.forEach(i,function(r,n){if("$"!==n[0]&&0!==n.indexOf("ng")&&"sfField"!==n){var f=function(r){e.isDefined(r)&&r!==o[n]&&(o[n]=r,u&&o.type&&(o.key||e.isUndefined(i.key))&&(t.form=o,u=!1))};"model"===n?t.$watch(r,function(e){e&&t.model!==e&&(t.model=e)}):"c"===a[n]?t.$watchCollection(r,f):i.$observe(n,f)}})}}})};this.createDecorator=function(e,t,r){i[e]={mappings:t||{},rules:r||[]},i[n]||(n=e),o(e)},this.createDirective=u,this.createDirectives=function(t){e.forEach(t,function(e,t){u(t,e)})},this.directive=function(e){return e=e||n,i[e]},this.addMapping=function(e,t,r){i[e]&&(i[e].mappings[t]=r)},this.$get=function(){return{directive:function(e){return i[e]},defaultDecorator:n}},o("sfDecorator")}])}),function(){"function"==typeof define&&define.amd&&define(["angular","angular-schema-form/module","angular-schema-form/sfPath"])}(this,function(e){e.module("schemaForm").provider("schemaForm",["sfPathProvider",function(t){var r=function(e){var t=[];return e.forEach(function(e){t.push({name:e,value:e})}),t},n=function(t,r){if(!e.isArray(t)){var n=[];return r?e.forEach(r,function(e){n.push({name:t[e],value:e})}):e.forEach(t,function(e,t){n.push({name:e,value:t})}),n}return t},i=function(e,t,r){var n=p[t.type];if(n)for(var i,a=0;a<n.length;a++)if(i=n[a](e,t,r))return i},a=function(t,r,i){i=i||{};var a=i.global&&i.global.formDefaults?e.copy(i.global.formDefaults):{};return a.title=i.global&&i.global.supressPropertyTitles===!0?r.title:r.title||t,r.description&&(a.description=r.description),(i.required===!0||r.required===!0)&&(a.required=!0),r.maxLength&&(a.maxlength=r.maxLength),r.minLength&&(a.minlength=r.maxLength),(r.readOnly||r.readonly)&&(a.readonly=!0),r.minimum&&(a.minimum=r.minimum+(r.exclusiveMinimum?1:0)),r.maximum&&(a.maximum=r.maximum-(r.exclusiveMaximum?1:0)),r.validationMessage&&(a.validationMessage=r.validationMessage),r.enumNames&&(a.titleMap=n(r.enumNames,r.enum)),a.schema=r,a.ngModelOptions=a.ngModelOptions||{},a},o=function(e,r,n){if("string"===r.type&&!r.enum){var i=a(e,r,n);return i.key=n.path,i.type="text",n.lookup[t.stringify(n.path)]=i,i}},u=function(e,r,n){if("number"===r.type){var i=a(e,r,n);return i.key=n.path,i.type="number",n.lookup[t.stringify(n.path)]=i,i}},f=function(e,r,n){if("integer"===r.type){var i=a(e,r,n);return i.key=n.path,i.type="number",n.lookup[t.stringify(n.path)]=i,i}},s=function(e,r,n){if("boolean"===r.type){var i=a(e,r,n);return i.key=n.path,i.type="checkbox",n.lookup[t.stringify(n.path)]=i,i}},c=function(e,n,i){if("string"===n.type&&n.enum){var o=a(e,n,i);return o.key=i.path,o.type="select",o.titleMap||(o.titleMap=r(n.enum)),i.lookup[t.stringify(i.path)]=o,o}},l=function(e,n,i){if("array"===n.type&&n.items&&n.items.enum){var o=a(e,n,i);return o.key=i.path,o.type="checkboxes",o.titleMap||(o.titleMap=r(n.items.enum)),i.lookup[t.stringify(i.path)]=o,o}},m=function(r,n,o){if("object"===n.type){var u=a(r,n,o);return u.type="fieldset",u.items=[],o.lookup[t.stringify(o.path)]=u,e.forEach(n.properties,function(e,r){var a=o.path.slice();if(a.push(r),o.ignore[t.stringify(a)]!==!0){var f=n.required&&-1!==n.required.indexOf(r),s=i(r,e,{path:a,required:f||!1,lookup:o.lookup,ignore:o.ignore});s&&u.items.push(s)}}),u}},d=function(e,r,n){if("array"===r.type){var o=a(e,r,n);o.type="array",o.key=n.path,n.lookup[t.stringify(n.path)]=o;var u=r.required&&-1!==r.required.indexOf(n.path(n.path.length-1)),f=n.path.slice();return f.push(""),o.items=[i(e,r.items,{path:f,required:u||!1,lookup:n.lookup,ignore:n.ignore})],o}},p={string:[c,o],object:[m],number:[u],integer:[f],"boolean":[s],array:[l,d]},h=function(e){return e};this.defaults=p,this.stdFormObj=a,this.defaultFormDefinition=i,this.postProcess=function(e){h=e},this.appendRule=function(e,t){p[e]||(p[e]=[]),p[e].push(t)},this.prependRule=function(e,t){p[e]||(p[e]=[]),p[e].unshift(t)},this.createStandardForm=a,this.$get=function(){var r={};return r.merge=function(i,a,o,u){a=a||["*"],u=u||{};var f=r.defaults(i,o,u),s=a.indexOf("*");if(-1!==s)return a=a.slice(0,s).concat(f.form).concat(a.slice(s+1));var c=f.lookup;return h(a.map(function(a){if("string"==typeof a&&(a={key:a}),a.key&&"string"==typeof a.key&&(a.key=t.parse(a.key)),a.titleMap&&(a.titleMap=n(a.titleMap)),a.itemForm){a.items=[];var u=t.stringify(a.key),f=c[u];e.forEach(f.items,function(t){var r=e.copy(a.itemForm);r.key=t.key,a.items.push(r)})}if(a.items&&(a.items=r.merge(i,a.items,o)),a.tabs&&e.forEach(a.tabs,function(e){e.items=r.merge(i,e.items,o)}),a.key){var u=t.stringify(a.key);c[u]&&(a=e.extend(c[u],a))}return"checkbox"===a.type&&e.isUndefined(a.schema["default"])&&(a.schema["default"]=!1),a}))},r.defaults=function(t,r,n){var a=[],o={};if(r=r||{},n=n||{},"object"!==t.type)throw new Error('Not implemented. Only type "object" allowed at root level of schema.');return e.forEach(t.properties,function(e,u){if(r[u]!==!0){var f=t.required&&-1!==t.required.indexOf(u),s=i(u,e,{path:[u],lookup:o,ignore:r,required:f,global:n});s&&a.push(s)}}),{form:a,lookup:o}},r.traverseSchema=function(t,r,n,i){i=e.isDefined(i)?i:!0,n=n||[];var a=function(t,r,n){if(r(t,n),e.forEach(t.properties,function(e,t){var i=n.slice();i.push(t),a(e,r,i)}),!i&&t.items){var o=n.slice();o.push(""),a(t.items,r,o)}};a(t,r,n||[])},r.traverseForm=function(t,n){n(t),e.forEach(t.items,function(e){r.traverseForm(e,n)}),t.tabs&&e.forEach(t.tabs,function(t){e.forEach(t.items,function(e){r.traverseForm(e,n)})})},r}}])}),function(e,t){"function"==typeof define&&define.amd?define(["angular","tv4","angular-schema-form/module"],t):t(angular,tv4)}(this,function(e,t){e.module("schemaForm").factory("sfValidator",[function(){var r={};return r.validate=function(r,n){var i=r.schema;if(!i)return n;"integer"===i.type?n=parseInt(n,10):"number"===i.type?n=parseFloat(n,10):"boolean"===i.type&&"string"==typeof n&&("true"===n?n=!0:"false"===n&&(n=!1));var a={type:"object",properties:{}},o=r.key[r.key.length-1];a.properties[o]=i,r.required&&(a.required=[o]);var u={};return e.isDefined(n)&&(u[o]=n),t.validateResult(u,a)},r}])}),function(e,t){function r(e){return"angular-schema-form/"+e}"function"==typeof define&&define.amd?define(["angular",r("module"),r("services/Select"),r("services/validator")]):t(angular)}(this,function(e){e.module("schemaForm").directive("sfArray",["sfSelect","schemaForm","sfValidator",function(t,r,n){var i=function(e){return function(t){t.key&&(t.key[t.key.indexOf("")]=e)}};return{restrict:"A",scope:!0,require:"?ngModel",link:function(a,o,u,f){var s={},c=a.$watch(u.sfArray,function(o){var u=t(o.key,a.model);if(e.isUndefined(u)&&(u=[],t(o.key,a.model,u)),a.modelArray=u,o.items){var l=o.items[0];o.items.length>1&&(l={type:"section",items:o.items})}if(a.copyWithIndex=function(t){if(!s[t]&&l){var n=e.copy(l);n.arrayIndex=t,r.traverseForm(n,i(t)),s[t]=n}return s[t]},a.appendToArray=function(){var n=u.length,i=a.copyWithIndex(n);if(r.traverseForm(i,function(r){r.key&&e.isDefined(r.default)&&t(r.key,a.model,r.default)}),n===u.length){var f,s=t("schema.items.type",o);"object"===s?f={}:"array"===s&&(f=[]),u.push(f)}return a.validateArray&&a.validateArray(),u},a.deleteFromArray=function(e){return u.splice(e,1),a.validateArray&&a.validateArray(),u},o.titleMap||o.startEmpty===!0||0!==u.length||a.appendToArray(),o.titleMap&&o.titleMap.length>0){a.titleMapValues=[];var m=function(e){a.titleMapValues=[],e=e||[],o.titleMap.forEach(function(t){a.titleMapValues.push(-1!==e.indexOf(t.value))})};m(a.modelArray),a.$watchCollection("modelArray",m),a.$watchCollection("titleMapValues",function(e){if(e){for(var t=a.modelArray;t.length>0;)t.shift();o.titleMap.forEach(function(r,n){e[n]&&t.push(r.value)})}})}if(f){var d;a.validateArray=function(){var e=n.validate(o,a.modelArray.length>0?a.modelArray:void 0);e.valid!==!1||!e.error||""!==e.error.dataPath&&e.error.dataPath!=="/"+o.key[o.key.length-1]?f.$setValidity("schema",!0):(f.$setViewValue(a.modelArray),d=e.error,f.$setValidity("schema",!1))},a.$on("schemaFormValidate",a.validateArray),a.hasSuccess=function(){return f.$valid&&!f.$pristine},a.hasError=function(){return f.$invalid},a.schemaError=function(){return d}}c()})}}}])}),function(e,t){"function"==typeof define&&define.amd?define(["angular","angular-schema-form/module"],t):t(angular)}(this,function(e){e.module("schemaForm").directive("sfChanged",function(){return{require:"ngModel",restrict:"AC",scope:!1,link:function(t,r,n,i){var a=t.$eval(n.sfChanged);a&&a.onChange&&i.$viewChangeListeners.push(function(){e.isFunction(a.onChange)?a.onChange(i.$modelValue,a):t.evalExpr(a.onChange,{modelValue:i.$modelValue,form:a})})}}})}),function(e,t){function r(e){return"angular-schema-form/"+e}if("function"==typeof define&&define.amd){var n=["angular",r("module"),r("services/schema-form"),r("services/decorators"),r("services/Select")];define(n,t)}}(this,function(e){e.module("schemaForm").directive("sfSchema",["$compile","schemaForm","schemaFormDecorators","sfSelect",function(t,r,n,i){var a=/[A-Z]/g,o=function(e,t){return t=t||"_",e.replace(a,function(e,r){return(r?t:"")+e.toLowerCase()})};return{scope:{schema:"=sfSchema",initialForm:"=sfForm",model:"=sfModel",options:"=sfOptions"},controller:["$scope",function(e){this.evalInParentScope=function(t,r){return e.$parent.$eval(t,r)}}],replace:!1,restrict:"A",transclude:!0,require:"?form",link:function(a,u,f,s,c){a.formCtrl=s;var l={};c(a,function(e){if(e.addClass("schema-form-ignore"),u.prepend(e),u[0].querySelectorAll){var t=u[0].querySelectorAll("[ng-model]");if(t)for(var r=0;r<t.length;r++){var n=t[r].getAttribute("ng-model");l[n.substring(n.indexOf(".")+1)]=!0}}});var m={};a.$watch(function(){var s=a.schema,c=a.initialForm||["*"];if(c&&s&&s.type&&(m.form!==c||m.schema!==s)&&Object.keys(s.properties).length>0){m.schema=s,m.form=c;var d=r.merge(s,c,l,a.options),p=document.createDocumentFragment();a.schemaForm={form:d,schema:s},e.forEach(d,function(e,t){var r=document.createElement(f.sfDecoratorName||o(n.defaultDecorator,"-"));r.setAttribute("form","schemaForm.form["+t+"]"),p.appendChild(r)}),u.children(":not(.schema-form-ignore)").remove(),u[0].appendChild(p),t(u.children())(a),r.traverseSchema(s,function(t,r){if(e.isDefined(t["default"])){var n=i(r,a.model);e.isUndefined(n)&&i(r,a.model,t["default"])}})}})}}}])}),function(e,t){"function"==typeof define&&define.amd?define(["angular","angular-schema-form/services/validator"],t):t(angular)}(this,function(e){e.module("schemaForm").directive("schemaValidate",["sfValidator",function(t){return{restrict:"A",scope:!1,require:"ngModel",link:function(r,n,i,a){r.ngModel=a;var o=null,u=r.$eval(i.schemaValidate),f=function(n){if(u||(u=r.$eval(i.schemaValidate)),!u)return n;if(e.isDefined(i.ngRequired)&&e.isUndefined(n))return void 0;""===n&&(n=void 0);var f=t.validate(u,n);return f.valid?(a.$setValidity("schema",!0),n):(a.$setValidity("schema",!1),void(o=f.error))};a.$parsers.unshift(f),r.$on("schemaFormValidate",function(){a.$commitViewValue?a.$commitViewValue(!0):a.$setViewValue(a.$viewValue)}),r.hasSuccess=function(){return a.$valid&&(!a.$pristine||!a.$isEmpty(a.$modelValue))},r.hasError=function(){return a.$invalid&&!a.$pristine},r.schemaError=function(){return o}}}}])});